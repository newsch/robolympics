(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29024,        739]
NotebookOptionsPosition[     26300,        684]
NotebookOutlinePosition[     26640,        699]
CellTagsIndexPosition[     26597,        696]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Motor Control Transfer Function", "Section",
 CellChangeTimes->{{3.750090426297629*^9, 
  3.7500904306556296`*^9}},ExpressionUUID->"e8779dfb-ce19-4fec-b522-\
e244be33a7b4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"subs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "\[Rule]", " ", "14"}], ",", " ", 
    RowBox[{"b", "\[Rule]", " ", 
     RowBox[{"1", "/", "400"}]}], ",", " ", 
    RowBox[{"g", "\[Rule]", " ", "9.8"}], ",", " ", 
    RowBox[{"l", "\[Rule]", " ", "0.04"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"motorBlock", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "*", "a"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"s", " ", "+", " ", "a"}], ")"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"motorErrorBlock", " ", "=", " ", 
    RowBox[{"jp", " ", "+", " ", 
     RowBox[{"ji", "/", "s"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"motorTransfer", " ", "=", " ", 
  RowBox[{"Factor", "[", 
   RowBox[{"motorErrorBlock", "*", 
    RowBox[{"motorBlock", "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"motorErrorBlock", "*", "motorBlock"}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7500873598377247`*^9, 3.750087376603876*^9}, {
  3.750087427599183*^9, 3.7500875264878635`*^9}, {3.7500876127924414`*^9, 
  3.750087637035485*^9}, {3.750090419037628*^9, 3.7500904211106286`*^9}, {
  3.7500927538381004`*^9, 3.750092767851107*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"57fecf9f-aba9-4a8f-8877-07bbe51457d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "\[Rule]", "14"}], ",", 
   RowBox[{"b", "\[Rule]", 
    FractionBox["1", "400"]}], ",", 
   RowBox[{"g", "\[Rule]", "9.8`"}], ",", 
   RowBox[{"l", "\[Rule]", "0.04`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7500913263106127`*^9, 3.7500927690221033`*^9, 
  3.7500928249841175`*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"d3d3aeb4-a8af-41ad-a0df-6913b2dd2654"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "b", " ", 
   RowBox[{"(", 
    RowBox[{"ji", "+", 
     RowBox[{"jp", " ", "s"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"a", " ", "b", " ", "ji"}], "+", 
   RowBox[{"a", " ", "s"}], "+", 
   RowBox[{"a", " ", "b", " ", "jp", " ", "s"}], "+", 
   SuperscriptBox["s", "2"]}]]], "Output",
 CellChangeTimes->{3.7500913263106127`*^9, 3.7500927690221033`*^9, 
  3.7500928249911165`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"1e43f169-1065-4b0a-ad54-93bc7848d907"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"roots", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Denominator", "[", "motorTransfer", "]"}], "\[Equal]", "0"}], 
      ",", " ", "s"}], "]"}], "/.", "subs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"nroots", "=", 
  RowBox[{"s", "/.", "roots"}]}]}], "Input",
 CellChangeTimes->{{3.750087534263937*^9, 3.7500875572510633`*^9}, {
  3.750087596442333*^9, 3.7500876086504135`*^9}, {3.7500876419674883`*^9, 
  3.750087683388492*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"e0c5d442-61a4-47f5-b9f1-897e85d2c580"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "14"}], "-", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"7", " ", "ji"}], "50"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"14", "+", 
           FractionBox[
            RowBox[{"7", " ", "jp"}], "200"]}], ")"}], "2"]}]], "-", 
      FractionBox[
       RowBox[{"7", " ", "jp"}], "200"]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "14"}], "+", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"7", " ", "ji"}], "50"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"14", "+", 
           FractionBox[
            RowBox[{"7", " ", "jp"}], "200"]}], ")"}], "2"]}]], "-", 
      FractionBox[
       RowBox[{"7", " ", "jp"}], "200"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.750087601558364*^9, 3.750087643476491*^9, 3.7500876777404904`*^9, 
   3.750087733076535*^9, 3.7500895725532722`*^9, {3.750091320002246*^9, 
   3.7500913290446067`*^9}, 3.750092790222107*^9, 3.7500928262683287`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"3ff16ab8-dac6-4c3d-be57-aa9d6f3f980d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"nroots", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ji", "\[Rule]", " ", "mji"}], ",", " ", 
            RowBox[{"jp", "\[Rule]", " ", "mjp"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Im", "[", 
         RowBox[{"nroots", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ji", "\[Rule]", " ", "mji"}], ",", " ", 
            RowBox[{"jp", "\[Rule]", " ", "mjp"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Real\>\"", ",", "\"\<Imaginary\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mji", ",", " ", "1259"}], "}"}], ",", " ", 
     RowBox[{"-", "2000"}], ",", " ", "2000", ",", " ", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mjp", ",", " ", 
       RowBox[{"-", "32"}]}], "}"}], ",", " ", 
     RowBox[{"-", "2000"}], ",", " ", "2000", ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7500876959655356`*^9, 3.7500877670425*^9}, {
  3.750087806836239*^9, 3.750087836276245*^9}, {3.7500878923802466`*^9, 
  3.7500879338562922`*^9}, {3.7500880023472595`*^9, 3.7500880145232863`*^9}, {
  3.750088047709263*^9, 3.750088050903291*^9}, {3.75009148334656*^9, 
  3.75009151674757*^9}, {3.75009154823458*^9, 3.750091555638612*^9}, {
  3.7500916514233446`*^9, 3.750091654676344*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"16aff9b7-e8fe-4adb-96c2-f1df9e8b21a5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`mji$$ = 1259, $CellContext`mjp$$ = -32, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`mji$$], 1259}, -2000, 2000, 1}, {{
       Hold[$CellContext`mjp$$], -32}, -2000, 2000, 1}}, Typeset`size$$ = {
    360., {109., 115.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`mji$90463$$ = 
    0, $CellContext`mjp$90464$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`mji$$ = 1259, $CellContext`mjp$$ = -32}, 
      "ControllerVariables" :> {
        Hold[$CellContext`mji$$, $CellContext`mji$90463$$, 0], 
        Hold[$CellContext`mjp$$, $CellContext`mjp$90464$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        Transpose[{
          Re[
           
           ReplaceAll[$CellContext`nroots, {$CellContext`ji -> \
$CellContext`mji$$, $CellContext`jp -> $CellContext`mjp$$}]], 
          Im[
           
           ReplaceAll[$CellContext`nroots, {$CellContext`ji -> \
$CellContext`mji$$, $CellContext`jp -> $CellContext`mjp$$}]]}], 
        AxesLabel -> {"Real", "Imaginary"}, PlotRange -> All], 
      "Specifications" :> {{{$CellContext`mji$$, 1259}, -2000, 2000, 
         1}, {{$CellContext`mjp$$, -32}, -2000, 2000, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {170., 176.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7500877342074957`*^9, 3.7500877681965003`*^9, {3.750087800876238*^9, 
   3.750087836737279*^9}, {3.750087883590247*^9, 3.750087885008247*^9}, {
   3.750087934391287*^9, 3.750087942142253*^9}, {3.7500880160542617`*^9, 
   3.750088020002261*^9}, 3.750088053177263*^9, {3.750091322145608*^9, 
   3.750091330206608*^9}, {3.7500915177435694`*^9, 3.7500915643605843`*^9}, {
   3.75009171583636*^9, 3.750091727414365*^9}, 3.7500927916271114`*^9, 
   3.750092828003117*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"4cb48714-0955-4eec-ab4b-644780c3e96c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall Transfer Function", "Section",
 CellChangeTimes->{{3.7500881833792763`*^9, 
  3.750088197163334*^9}},ExpressionUUID->"7a7aac1e-903a-4dc5-85d0-\
a05cc83a26b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pendulumBlock", "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"-", "s"}], 
     RowBox[{
      RowBox[{"l", " ", 
       SuperscriptBox["s", "2"]}], "-", "g"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"integratorBlock", "=", 
   FractionBox["k", "s"]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pwmBlock", "=", 
   RowBox[{"kp", "+", 
    FractionBox["ki", "s"]}]}], ";"}], "\n", 
 RowBox[{"motorControlBlock", "=", 
  RowBox[{"motorTransfer", "/.", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"jp", "\[Rule]", 
      RowBox[{"-", "32"}]}], ",", 
     RowBox[{"ji", "\[Rule]", "624"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7500882262792807`*^9, 3.7500883688211718`*^9}, {
   3.7500884101887493`*^9, 3.750088465680753*^9}, {3.7500884975547624`*^9, 
   3.7500885367098207`*^9}, {3.750091771235377*^9, 3.7500917914823823`*^9}, 
   3.7500920431274557`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"df098da7-2091-48ec-b65d-e65e5afbe84f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "b", " ", 
   RowBox[{"(", 
    RowBox[{"624", "-", 
     RowBox[{"32", " ", "s"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"624", " ", "a", " ", "b"}], "+", 
   RowBox[{"a", " ", "s"}], "-", 
   RowBox[{"32", " ", "a", " ", "b", " ", "s"}], "+", 
   SuperscriptBox["s", "2"]}]]], "Output",
 CellChangeTimes->{
  3.7500884465097528`*^9, 3.750088859074199*^9, {3.750089554344285*^9, 
   3.750089577694275*^9}, 3.750091332885609*^9, 3.750091802650385*^9, 
   3.750092044548627*^9, 3.7500928370531206`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"fd2d1d8b-8438-4d24-954f-d1f4f60ef054"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"\[Theta]", "[", "s", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"P", "[", "s", "]"}], 
    RowBox[{"V", "[", "s", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"V", "[", "s", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"e", "[", "s", "]"}], 
    RowBox[{"Md", "[", "s", "]"}], 
    RowBox[{"M", "[", "s", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq3", "=", 
  RowBox[{
   RowBox[{"e", "[", "s", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Theta]", "[", "s", "]"}]}], "+", 
    RowBox[{
     RowBox[{"i", "[", "s", "]"}], 
     RowBox[{"V", "[", "s", "]"}]}], "+", 
    RowBox[{"\[Theta]d", "[", "s", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.750088551136814*^9, 3.750088670876775*^9}, {
  3.7500887362141886`*^9, 3.7500887649141912`*^9}, {3.7500889015952034`*^9, 
  3.7500889365882273`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"22de167d-e272-4af4-98f4-3e6a6de68ff6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", "[", "s", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"P", "[", "s", "]"}], " ", 
   RowBox[{"V", "[", "s", "]"}]}]}]], "Output",
 CellChangeTimes->{3.750091335249787*^9, 3.7500918061983852`*^9, 
  3.7500920470874543`*^9, 3.750092843041171*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"c5069591-561a-4d21-80b0-d2ac1cea08ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "[", "s", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"e", "[", "s", "]"}], " ", 
   RowBox[{"M", "[", "s", "]"}], " ", 
   RowBox[{"Md", "[", "s", "]"}]}]}]], "Output",
 CellChangeTimes->{3.750091335249787*^9, 3.7500918061983852`*^9, 
  3.7500920470874543`*^9, 3.750092843050144*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"eb100f7f-fc4e-4eaa-af6c-671f57560c1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"e", "[", "s", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    RowBox[{"i", "[", "s", "]"}], " ", 
    RowBox[{"V", "[", "s", "]"}]}], "-", 
   RowBox[{"\[Theta]", "[", "s", "]"}], "+", 
   RowBox[{"\[Theta]d", "[", "s", "]"}]}]}]], "Output",
 CellChangeTimes->{3.750091335249787*^9, 3.7500918061983852`*^9, 
  3.7500920470874543`*^9, 3.750092843054123*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"b5442054-95a2-49e1-bdcd-a9b6ec9ddc7a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqsubs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", "s", "]"}], "\[Rule]", " ", "pendulumBlock"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"i", "[", "s", "]"}], "\[Rule]", " ", "integratorBlock"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"Md", "[", "s", "]"}], "\[Rule]", " ", "pwmBlock"}], ",", " ", 
     RowBox[{
      RowBox[{"M", "[", "s", "]"}], "\[Rule]", " ", "motorControlBlock"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7500895979296093`*^9, 3.750089654559001*^9}, 
   3.7500896968262854`*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"3c9549a1-895f-448e-92f8-10dfdd4c522a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eq1", ",", " ", "eq2", ",", " ", "eq3"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "s", "]"}], ",", " ", 
        RowBox[{"V", "[", "s", "]"}], ",", " ", 
        RowBox[{"e", "[", "s", "]"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"totalSys", "[", "s", "]"}], "\[Rule]", " ", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "s", "]"}], "/", 
     RowBox[{"\[Theta]d", "[", "s", "]"}]}]}], "/.", "sol"}], "}"}]}], "Input",
 CellChangeTimes->{{3.750088704552187*^9, 3.750088716159187*^9}, {
  3.7500887785981946`*^9, 3.7500888071741943`*^9}, {3.750088924686221*^9, 
  3.7500889252042294`*^9}, {3.7500890601062317`*^9, 3.750089070377221*^9}, {
  3.750089103665242*^9, 3.7500893013312464`*^9}, {3.750089332907251*^9, 
  3.750089412815296*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"43db5c3c-7631-4426-8072-7cd036ee4b0d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"totalSys", "[", "s", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"M", "[", "s", "]"}], " ", 
     RowBox[{"Md", "[", "s", "]"}], " ", 
     RowBox[{"P", "[", "s", "]"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"i", "[", "s", "]"}], " ", 
      RowBox[{"M", "[", "s", "]"}], " ", 
      RowBox[{"Md", "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"M", "[", "s", "]"}], " ", 
      RowBox[{"Md", "[", "s", "]"}], " ", 
      RowBox[{"P", "[", "s", "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.750088808852197*^9, {3.7500889214312353`*^9, 3.750088940769309*^9}, 
   3.750089071335223*^9, {3.750089120799263*^9, 3.7500891500642567`*^9}, {
   3.7500892347652397`*^9, 3.750089254697268*^9}, {3.7500893892882853`*^9, 
   3.7500894136322575`*^9}, 3.7500913376403785`*^9, 3.7500918084003863`*^9, 
   3.750092049172455*^9, 3.75009284659716*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"5c6781f0-6e2d-4efe-aa97-08f5b432d6e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalTransferFunc", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[Theta]", "[", "s", "]"}], 
      RowBox[{"\[Theta]d", "[", "s", "]"}]], "/.", "\[VeryThinSpace]", 
     "sol"}], "/.", "\[VeryThinSpace]", "eqsubs"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.75008942930726*^9, 3.7500895328452907`*^9}, {
  3.750089700894311*^9, 3.750089709763398*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"f951fdf6-6533-4cf6-814f-e745acd09127"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"16", " ", "a", " ", "b", " ", 
      SuperscriptBox["s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "39"}], "+", 
        RowBox[{"2", " ", "s"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"ki", "+", 
        RowBox[{"kp", " ", "s"}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"624", " ", "a", " ", "b", " ", "g", " ", "k", " ", "ki"}], "-", 
      RowBox[{
      "32", " ", "a", " ", "b", " ", "g", " ", "k", " ", "ki", " ", "s"}], 
      "+", 
      RowBox[{
      "624", " ", "a", " ", "b", " ", "g", " ", "k", " ", "kp", " ", "s"}], 
      "-", 
      RowBox[{"624", " ", "a", " ", "b", " ", "g", " ", 
       SuperscriptBox["s", "2"]}], "+", 
      RowBox[{"624", " ", "a", " ", "b", " ", "ki", " ", 
       SuperscriptBox["s", "2"]}], "-", 
      RowBox[{"32", " ", "a", " ", "b", " ", "g", " ", "k", " ", "kp", " ", 
       SuperscriptBox["s", "2"]}], "-", 
      RowBox[{"624", " ", "a", " ", "b", " ", "k", " ", "ki", " ", "l", " ", 
       SuperscriptBox["s", "2"]}], "-", 
      RowBox[{"a", " ", "g", " ", 
       SuperscriptBox["s", "3"]}], "+", 
      RowBox[{"32", " ", "a", " ", "b", " ", "g", " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{"32", " ", "a", " ", "b", " ", "ki", " ", 
       SuperscriptBox["s", "3"]}], "+", 
      RowBox[{"624", " ", "a", " ", "b", " ", "kp", " ", 
       SuperscriptBox["s", "3"]}], "+", 
      RowBox[{"32", " ", "a", " ", "b", " ", "k", " ", "ki", " ", "l", " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{"624", " ", "a", " ", "b", " ", "k", " ", "kp", " ", "l", " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{"g", " ", 
       SuperscriptBox["s", "4"]}], "-", 
      RowBox[{"32", " ", "a", " ", "b", " ", "kp", " ", 
       SuperscriptBox["s", "4"]}], "+", 
      RowBox[{"624", " ", "a", " ", "b", " ", "l", " ", 
       SuperscriptBox["s", "4"]}], "+", 
      RowBox[{"32", " ", "a", " ", "b", " ", "k", " ", "kp", " ", "l", " ", 
       SuperscriptBox["s", "4"]}], "+", 
      RowBox[{"a", " ", "l", " ", 
       SuperscriptBox["s", "5"]}], "-", 
      RowBox[{"32", " ", "a", " ", "b", " ", "l", " ", 
       SuperscriptBox["s", "5"]}], "+", 
      RowBox[{"l", " ", 
       SuperscriptBox["s", "6"]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.750089705893387*^9, 3.750089718684493*^9}, 
   3.750091338790402*^9, 3.750091809426428*^9, 3.750092050280509*^9, 
   3.750092849278125*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"7a2918d3-cd08-4114-b901-b531d20237dd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"roots1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Denominator", "[", "totalTransferFunc", "]"}], "\[Equal]", 
       "0"}], ",", " ", "s"}], "]"}], "/.", "subs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.750089733311568*^9, 3.7500897677537155`*^9}, {
   3.750089813927*^9, 3.7500898184810395`*^9}, 3.7500899838901577`*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"17c6c9f4-72d1-4d11-ba2b-fb47314aa4b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"s", "/.", "roots1"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ki", "\[Rule]", "mKi"}], ",", 
            RowBox[{"kp", "\[Rule]", "mKp"}], ",", " ", 
            RowBox[{"k", "\[Rule]", " ", "mK"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Im", "[", 
         RowBox[{
          RowBox[{"s", "/.", "roots1"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ki", "\[Rule]", "mKi"}], ",", 
            RowBox[{"kp", "\[Rule]", "mKp"}], ",", " ", 
            RowBox[{"k", "\[Rule]", " ", "mK"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Real\>\"", ",", "\"\<Imaginary\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mKi", ",", " ", "1760"}], "}"}], ",", 
     RowBox[{"-", "4000"}], ",", "200"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mKp", ",", " ", "3000"}], "}"}], ",", 
     RowBox[{"-", "4000"}], ",", " ", "200"}], "}"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mK", ",", " ", 
       RowBox[{"-", "0.2"}]}], "}"}], ",", " ", 
     RowBox[{"-", "25"}], ",", " ", "25"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.75008987835744*^9, 3.750089924513754*^9}, {
  3.7500899614660044`*^9, 3.750089964227023*^9}, {3.7500900313105063`*^9, 
  3.750090032278486*^9}, {3.7500900679487495`*^9, 3.7500900738908052`*^9}, {
  3.750090112952035*^9, 3.750090130502183*^9}, {3.750090165800394*^9, 
  3.7500901844805565`*^9}, {3.750090295902616*^9, 3.750090313128645*^9}, {
  3.750090361727648*^9, 3.7500903834736247`*^9}, {3.750092102096476*^9, 
  3.7500921139034758`*^9}, {3.75009214559422*^9, 3.7500921589599047`*^9}, {
  3.750092888084135*^9, 3.75009290213914*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"62e1aa20-aea2-4bbb-a78d-4a52d4b2784b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`mK$$ = 
    20.200000000000003`, $CellContext`mKi$$ = -2560., $CellContext`mKp$$ = 
    80., Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`mKi$$], 1760}, -4000, 200}, {{
       Hold[$CellContext`mKp$$], 3000}, -4000, 200}, {{
       Hold[$CellContext`mK$$], -0.2}, -25, 25}}, Typeset`size$$ = {
    360., {109., 115.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`mKi$100903$$ = 
    0, $CellContext`mKp$100904$$ = 0, $CellContext`mK$100905$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`mK$$ = -0.2, $CellContext`mKi$$ = 
        1760, $CellContext`mKp$$ = 3000}, "ControllerVariables" :> {
        Hold[$CellContext`mKi$$, $CellContext`mKi$100903$$, 0], 
        Hold[$CellContext`mKp$$, $CellContext`mKp$100904$$, 0], 
        Hold[$CellContext`mK$$, $CellContext`mK$100905$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        Transpose[{
          Re[
           ReplaceAll[
            
            ReplaceAll[$CellContext`s, $CellContext`roots1], {$CellContext`ki -> \
$CellContext`mKi$$, $CellContext`kp -> $CellContext`mKp$$, $CellContext`k -> \
$CellContext`mK$$}]], 
          Im[
           ReplaceAll[
            
            ReplaceAll[$CellContext`s, $CellContext`roots1], {$CellContext`ki -> \
$CellContext`mKi$$, $CellContext`kp -> $CellContext`mKp$$, $CellContext`k -> \
$CellContext`mK$$}]]}], AxesLabel -> {"Real", "Imaginary"}, PlotRange -> All],
       "Specifications" :> {{{$CellContext`mKi$$, 1760}, -4000, 
         200}, {{$CellContext`mKp$$, 3000}, -4000, 
         200}, {{$CellContext`mK$$, -0.2}, -25, 25}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {184., 190.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7500899286168127`*^9, {3.750089964864027*^9, 3.750089987148179*^9}, 
   3.7500900756377945`*^9, {3.750090107347996*^9, 3.7500901326542015`*^9}, 
   3.7500901897195873`*^9, {3.7500903007486153`*^9, 3.7500903143736963`*^9}, {
   3.7500903552236214`*^9, 3.7500903841646233`*^9}, 3.75009134182979*^9, 
   3.7500918112643876`*^9, 3.750092052748456*^9, {3.7500920899284654`*^9, 
   3.7500920934044676`*^9}, 3.750092159431902*^9, 3.7500928544251366`*^9, 
   3.7500929027011385`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"33aefb6a-15ba-4422-9882-ff341bc4994d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{838, 997},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 178, 3, 67, "Section",ExpressionUUID->"e8779dfb-ce19-4fec-b522-e244be33a7b4"],
Cell[CellGroupData[{
Cell[783, 29, 1371, 35, 86, "Input",ExpressionUUID->"57fecf9f-aba9-4a8f-8877-07bbe51457d5"],
Cell[2157, 66, 420, 10, 55, "Output",ExpressionUUID->"d3d3aeb4-a8af-41ad-a0df-6913b2dd2654"],
Cell[2580, 78, 504, 13, 61, "Output",ExpressionUUID->"1e43f169-1065-4b0a-ad54-93bc7848d907"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3121, 96, 594, 14, 48, "Input",ExpressionUUID->"e0c5d442-61a4-47f5-b9f1-897e85d2c580"],
Cell[3718, 112, 1339, 41, 80, "Output",ExpressionUUID->"3ff16ab8-dac6-4c3d-be57-aa9d6f3f980d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5094, 158, 2026, 47, 238, "Input",ExpressionUUID->"16aff9b7-e8fe-4adb-96c2-f1df9e8b21a5"],
Cell[7123, 207, 2784, 55, 365, "Output",ExpressionUUID->"4cb48714-0955-4eec-ab4b-644780c3e96c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9956, 268, 172, 3, 67, "Section",ExpressionUUID->"7a7aac1e-903a-4dc5-85d0-a05cc83a26b7"],
Cell[CellGroupData[{
Cell[10153, 275, 996, 27, 168, "Input",ExpressionUUID->"df098da7-2091-48ec-b65d-e65e5afbe84f"],
Cell[11152, 304, 624, 15, 59, "Output",ExpressionUUID->"fd2d1d8b-8438-4d24-954f-d1f4f60ef054"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11813, 324, 998, 27, 67, "Input",ExpressionUUID->"22de167d-e272-4af4-98f4-3e6a6de68ff6"],
Cell[12814, 353, 367, 8, 32, "Output",ExpressionUUID->"c5069591-561a-4d21-80b0-d2ac1cea08ad"],
Cell[13184, 363, 400, 9, 32, "Output",ExpressionUUID->"eb100f7f-fc4e-4eaa-af6c-671f57560c1f"],
Cell[13587, 374, 469, 11, 32, "Output",ExpressionUUID->"b5442054-95a2-49e1-bdcd-a9b6ec9ddc7a"]
}, Open  ]],
Cell[14071, 388, 674, 18, 28, "Input",ExpressionUUID->"3c9549a1-895f-448e-92f8-10dfdd4c522a"],
Cell[CellGroupData[{
Cell[14770, 410, 1102, 26, 48, "Input",ExpressionUUID->"43db5c3c-7631-4426-8072-7cd036ee4b0d"],
Cell[15875, 438, 1014, 24, 59, "Output",ExpressionUUID->"5c6781f0-6e2d-4efe-aa97-08f5b432d6e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16926, 467, 500, 11, 55, "Input",ExpressionUUID->"f951fdf6-6533-4cf6-814f-e745acd09127"],
Cell[17429, 480, 2626, 60, 102, "Output",ExpressionUUID->"7a2918d3-cd08-4114-b901-b531d20237dd"]
}, Open  ]],
Cell[20070, 543, 486, 11, 28, "Input",ExpressionUUID->"17c6c9f4-72d1-4d11-ba2b-fb47314aa4b8"],
Cell[CellGroupData[{
Cell[20581, 558, 2481, 58, 257, "Input",ExpressionUUID->"62e1aa20-aea2-4bbb-a78d-4a52d4b2784b"],
Cell[23065, 618, 3207, 62, 426, "Output",ExpressionUUID->"33aefb6a-15ba-4422-9882-ff341bc4994d"]
}, Open  ]]
}, Open  ]]
}
]
*)

